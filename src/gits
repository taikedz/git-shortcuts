#!/usr/bin/env bash

set -euo pipefail

#%include help.sh

#%include autohelp.sh out.sh

#%include modules.sh

gits:main() {

    local action

    action="${1:-}"; shift || :

    [[ -n "$action" ]] || {
        gits:status:short
        echo
        out:info "${CBBLU}(see also: gits fs)"
        exit
    }

    case "$action" in
    -mm)
        gits:commit "$action" "$@"
        ;;
    help)
        autohelp:print help
        ;;
    fs)
        gits:status:fetch "$@"
        ;;
    status)
        gits:status:short "$@"
        ;;
    log)
        gits:log "$@"
        ;;
    profile)
        gits:profiles:_dispatch "$@"
        ;;
    push)
        gits:push "$@"
        ;;
    pull)
        gits:pull:_dispatch "$@"
        ;;
    gc)
        gits:gc-full "$@"
        ;;
    branch)
        gits:branch:_dispatch "$@"
        ;;
    --help)
        autohelp:print
        exit 0
        ;;
    diff)
        gits:diff "$@"
        ;;
    *)
        gits:diff "$action" "$@"
        ;;
    esac
}

gits:main "$@"
